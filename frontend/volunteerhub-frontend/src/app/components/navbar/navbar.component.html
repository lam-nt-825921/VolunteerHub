<nav class="navbar" [class.menu-open]="isMenuOpen()">
  <div class="navbar-container">
    <!-- Logo with Title and Subtitle -->
    <div class="navbar-brand">
      <a href="/" class="logo-link">
        <img 
          src="/LOGO_Volunteer-Hub.png" 
          alt="Logo VolunteerHub" 
          class="logo-img"
        />
        <div class="brand-text">
          <h1 class="brand-title">VolunteerHub</h1>
          <p class="brand-subtitle">Kết nối con người, lan tỏa yêu thương</p>
        </div>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <ul class="navbar-menu desktop-menu">
      <li><a routerLink="/" class="nav-link">Trang chủ</a></li>
      <li><a routerLink="/events" class="nav-link">Sự kiện</a></li>
      @if (authService.isAuthenticated()) {
        <li>
          <a routerLink="/dashboard" class="nav-link">Dashboard</a>
        </li>
      }
    </ul>

    <!-- Theme Toggle, Login/User Menu & Mobile Menu Button -->
    <div class="navbar-actions">
      @if (authService.isAuthenticated()) {
        <app-notification-bell></app-notification-bell>
        <div class="user-menu desktop-only">
          <span class="user-name">{{ authService.user()?.name }}</span>
          <button class="btn-logout" (click)="logout()" title="Đăng xuất">
            <mat-icon>logout</mat-icon>
          </button>
        </div>
      } @else {
        <button class="btn-login desktop-only" (click)="openLoginModal()">
          <mat-icon>login</mat-icon>
          <span class="login-text">Đăng nhập</span>
        </button>
      }

      <button 
        class="theme-toggle" 
        (click)="toggleTheme()"
        [attr.aria-label]="isDarkMode() ? 'Chuyển sang chế độ sáng' : 'Chuyển sang chế độ tối'"
        [attr.title]="isDarkMode() ? 'Chuyển sang chế độ sáng' : 'Chuyển sang chế độ tối'"
      >
        @if (isDarkMode()) {
          <mat-icon>light_mode</mat-icon>
        } @else {
          <mat-icon>dark_mode</mat-icon>
        }
      </button>

      <button 
        class="mobile-menu-toggle" 
        (click)="toggleMenu()"
        [attr.aria-label]="isMenuOpen() ? 'Đóng menu' : 'Mở menu'"
        [attr.title]="isMenuOpen() ? 'Đóng menu' : 'Mở menu'"
        [attr.aria-expanded]="isMenuOpen()"
      >
        <span class="sr-only">{{ isMenuOpen() ? 'Đóng menu' : 'Mở menu' }}</span>
        <span class="hamburger-line" [class.active]="isMenuOpen()"></span>
        <span class="hamburger-line" [class.active]="isMenuOpen()"></span>
        <span class="hamburger-line" [class.active]="isMenuOpen()"></span>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <div class="mobile-menu" [class.open]="isMenuOpen()">
    <ul class="navbar-menu mobile-menu-list">
      <li><a routerLink="/" class="nav-link" (click)="closeMenu()">Trang chủ</a></li>
      <li><a routerLink="/events" class="nav-link" (click)="closeMenu()">Sự kiện</a></li>
      @if (authService.isAuthenticated()) {
        <li>
          <a routerLink="/dashboard" class="nav-link" (click)="closeMenu()">Dashboard</a>
        </li>
        <li class="mobile-user-info">
          <span class="user-name">{{ authService.user()?.name }}</span>
        </li>
        <li>
          <button class="btn-logout mobile-logout" (click)="logout(); closeMenu()">
            <mat-icon>logout</mat-icon>
            <span>Đăng xuất</span>
          </button>
        </li>
      } @else {
        <li>
          <button class="btn-login mobile-login" (click)="openLoginModal(); closeMenu()">
            <mat-icon>login</mat-icon>
            <span>Đăng nhập</span>
          </button>
        </li>
      }
    </ul>
  </div>
</nav>

@if (showLoginModal()) {
  <app-login-modal
    (close)="closeLoginModal()"
    (switchToRegister)="closeLoginModal()"
    (loginSuccess)="onLoginSuccess()"
  ></app-login-modal>
}

